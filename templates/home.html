{% extends "base.html" %}

{% block title %}صفحه اصلی{% endblock %}

{% block extra_head %}

{% endblock extra_head %}

{% block content %}
<body class="bg-gray-50">

    <!-- Main Content -->
    <main>
        <div class="shadow-lg rounded-2xl overflow-hidden">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="container mx-auto pl-4 pr-12 grid lg:grid-cols-2 items-center gap-8 py-12 md:py-20">
                <div class="text-center lg:text-right">
                    <h1 class="text-4xl md:text-6xl font-extrabold text-gray-800 leading-tight">
                        کیفیت و نوآوری، <br/> <span class="text-primary-red">برای زندگی بهتر.</span>
                    </h1>
                    <p class="mt-6 mb-8 text-gray-600 text-lg max-w-lg mx-auto lg:mx-0">
                        جدیدترین محصولات دیجیتال و لوازم خانگی را با ضمانت اصالت و بهترین قیمت از ما بخواهید.
                    </p>
                    <a href="{% url 'products:product_list' %}" class="btn-primary inline-block">
                        مشاهده همه محصولات <i class="fas fa-arrow-left mr-2"></i>
                    </a>
                </div>
                <div class="flex justify-center">
                    <img src="{{ popular_products.0.get_main_image_url }}" alt="محصول ویژه: {{ popular_products.0.name }}" class="rounded-lg shadow-2xl w-full max-w-sm md:max-w-md">
                </div>
            </div>
        </section>

        <!-- Features/Trust Bar -->
        <section class="bg-white">
            <div class="container mx-auto px-4 py-8">
                <div class="grid grid-cols-2 md:grid-cols-4 gap-8 text-center">
                    <div class="flex items-center justify-center">
                        <i class="fas fa-truck-fast text-primary-red text-3xl ml-4"></i>
                        <div>
                            <h4 class="font-bold text-gray-800">ارسال سریع</h4>
                            <p class="text-sm text-gray-500">در سراسر کشور</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-center">
                        <i class="fas fa-shield-alt text-primary-red text-3xl ml-4"></i>
                        <div>
                            <h4 class="font-bold text-gray-800">پرداخت امن</h4>
                            <p class="text-sm text-gray-500">درگاه پرداخت معتبر</p>
                        </div>
                    </div>
                    <div class="flex items-center justify-center">
                        <i class="fas fa-headset text-primary-red text-3xl ml-4"></i>
                        <div>
                            <h4 class="font-bold text-gray-800">پشتیبانی ۲۴/۷</h4>
                            <p class="text-sm text-gray-500">همیشه در کنار شماییم</p>
                        </div>
                    </div>
                     <div class="flex items-center justify-center">
                        <i class="fas fa-check-circle text-primary-red text-3xl ml-4"></i>
                        <div>
                            <h4 class="font-bold text-gray-800">ضمانت اصالت</h4>
                            <p class="text-sm text-gray-500">کالاهای اورجینال</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        </div>


        <!-- Visual Categories Section -->
        <section class="container mx-auto px-4 py-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">خرید بر اساس دسته‌بندی</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <a href="{{ popular_category.1.get_absolute_url }}" class="relative rounded-lg overflow-hidden h-80 block group">
                    <div class="category-card-bg absolute inset-0" style="background-image: url('{{ popular_category.1.image.url|default:"" }}')"></div>
                    <div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-50 transition-all"></div>
                    <h3 class="absolute bottom-6 right-6 text-white text-2xl font-bold">{{ popular_category.1.name }}</h3>
                </a>
                <a href="{{ popular_category.0.get_absolute_url }}" class="relative rounded-lg overflow-hidden h-80 block group">
                    <div class="category-card-bg absolute inset-0" style="background-image: url('{{ popular_category.0.image.url|default:"" }}')"></div>
                    <div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-50 transition-all"></div>
                    <h3 class="absolute bottom-6 right-6 text-white text-2xl font-bold">{{ popular_category.0.name }}</h3>
                </a>
                <a href="{{ popular_category.2.get_absolute_url }}" class="relative rounded-lg overflow-hidden h-80 block group">
                    <div class="category-card-bg absolute inset-0" style="background-image: url('{{ popular_category.2.image.url|default:"" }}')"></div>
                    <div class="absolute inset-0 bg-black bg-opacity-40 group-hover:bg-opacity-50 transition-all"></div>
                    <h3 class="absolute bottom-6 right-6 text-white text-2xl font-bold">{{ popular_category.2.name }}</h3>
                </a>
            </div>
        </section>

        <!-- Featured Products Section -->
        <section class="bg-white rounded-2xl shadow-lg container mx-auto px-4 py-12">
            <div class="flex justify-between items-center mb-8">
                <h2 class="text-3xl font-bold text-gray-800">محصولات منتخب</h2>
                <a href="{% url 'products:product_list' %}" class="text-primary-red font-semibold hover:underline">مشاهده همه</a>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Main Featured Product -->
                <div class="product-card lg:col-span-2 lg:row-span-2 bg-white border rounded-lg overflow-hidden 
                        flex flex-col md:flex-row lg:flex-col gc-1-3">
                    <a href="{{ popular_products.1.get_absolute_url }}" class="block md:w-1/2 lg:w-full">
                        <img src="{{ popular_products.1.get_main_image_url }}" alt="popular_products.1.name" class="w-full h-full object-cover">
                    </a>
                    <div class="p-6 flex flex-col justify-center flex-1">
                        <h3 class="font-bold text-2xl text-gray-800">{{ popular_products.1.name }}</h3>
                        <p class="text-gray-500 my-3">{{ popular_products.1.description_short }}</p>
                        <div class="flex justify-between items-center mt-4">
                            <span class="text-primary-red font-bold text-2xl">{{ popular_products.1.get_display_price|floatformat:0 }}<span class="text-sm">تومان</span></span>
                            <div class="text-yellow-400 text-lg">
                                <i class="fas fa-star"></i> 4.8
                            </div>
                        </div>
                        {% if popular_products.1.is_active %}
                            <form method="POST" action="{% url 'cart_and_orders:add_to_cart' %}" class="w-full add-to-cart-form"> {# TODO: Update action to actual add to cart URL #}
                                {% csrf_token %}
                                <input type="hidden" name="product_id" value="{{ popular_products.1.id }}">
                                <input type="hidden" name="quantity" value="1" min="1" {% if popular_products.1.stock > 0 %}max="{{ popular_products.1.stock }}"{% else %}max="0" disabled{% endif %}>
                                <button type="submit" class="w-full mt-6 btn-primary" {% if popular_products.1.stock <= 0 or not popular_products.1.is_active %}disabled{% endif %}>
                                    افزودن به سبد خرید
                                </button>
                            </form>
                        {% else %}
                            <p class="w-full mt-6 btn-primary">این محصول در حال حاضر موجود نیست.</p>
                        {% endif %}
                    </div>
                </div>
                <!-- Other Products -->
                {% for product in popular_products|slice:"2:" %}
                <div class="product-card bg-white border rounded-lg overflow-hidden">
                    <a href="{{ product.get_absolute_url }}">
                        <img src="{{ product.get_main_image_url }}" alt="{{ product.name }}" class="w-full h-48 object-cover">
                    </a>
                    <div class="p-4">
                        <h3 class="font-semibold text-gray-800 h-12">{{ product.name }}</h3>
                        <div class="flex justify-between items-center mt-4">
                            <span class="text-primary-red font-bold text-lg">
                                {{ product.get_display_price|floatformat:0 }} <span class="text-sm">تومان</span>
                            </span>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

    </main>

    

</body>
{% endblock %} 